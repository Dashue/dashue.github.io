
<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <meta http-equiv="last-modified" content="2014-06-10T19:04:49.9973817-04:00" />
    <meta name="keywords" content=".Net,AngularJs,Javascript,Opensource,Software Development" />
    <title>johanilsson.com</title>
    <link rel="stylesheet" type="text/css" href="/stylesheets/font-awesome/css/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="/stylesheets/style.css" />
    <link rel="canonical" href="http://www.johanilsson.com/" />
</head>
<body class="home blog">
    <div id="page" class="hfeed site">
        <header id="masthead" class="site-header" role="banner">
            <hgroup>
            </hgroup>
            <nav role="navigation" class="site-navigation main-navigation">
                <h1 class="assistive-text">Menu</h1>
                <div class="assistive-text skip-link"><a href="#content" title="Skip to content">Skip to content</a></div>
                <div class="menu">
                    <small>
                        <a href="https://github.com/dashue" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://github.com']);">GitHub</a>
                        <a href="https://www.goodreads.com/user/show/18905539-johan-nilsson" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','https://www.goodreads.com/user/show/18905539-johan-nilsson']);">Goodreads</a>
                        <a href="http://www.linkedin.com/in/dashu" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://www.linkedin.com']);">LinkedIn</a>
                        <a href="http://stackoverflow.com/users/651787/dashu" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://stackoverflow.com']);">Stack Overflow</a>
                        <a href="https://twitter.com/johanilsson" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://twitter.com']);">Twitter</a>
                        <br/>
                        <a href="http://feeds.feedburner.com/johanilsson">Subscribe</a>
                    </small>
                </div>
            </nav>
        </header>
        <div id="main">
            <div id="primary" class="site-content">
                <div id="content" role="main">
                  
  <ul class="posts">
      <li class="post">
        <a href="/2014/05/a-little-gem-called-hashset/">
          <i>A little gem called Hashset</i>
          <span style="float:right">.Net</span>
            
            <p>Showing one scenario where Hashset is more appropriate than Dictionary</p>

        </a>
      </li>
      <li class="post">
        <a href="/2014/04/angularjs-eventbus/">
          <i>AngularJs EventBus</i>
          <span style="float:right">AngularJs | Javascript</span>
            
            <p>This post introduces the EventBus functionality of angularjs and explains two ways of using it.</p>

        </a>
      </li>
      <li class="post">
        <a href="/2013/12/making-angularjs-directives-re-usable-by-passing-parameters/">
          <i>Making angularjs directives re-usable by &quot;Passing parameters&quot;</i>
          <span style="float:right">AngularJs | Javascript</span>
            
            <p>A look at the techniques available for building re-usable angularjs directives.</p>

        </a>
      </li>
      <li class="post">
        <a href="/2013/12/locking-made-easy/">
          <i>Locking made easy</i>
          <span style="float:right">.Net</span>
            
            <p>Locking is hard, here is one solution to making it less so.</p>

        </a>
      </li>
      <li class="post">
        <a href="/2013/11/configurationsection-a-testable-and-dependable-configuration-solution/">
          <i>ConfigurationSection &quot;A testable, dependable configuration solution&quot;</i>
          <span style="float:right">.Net</span>
            
            <p>Most every application and service needs configuration of some sort. This post explains an approach that offers testability.</p>

        </a>
      </li>
      <li class="post">
        <a href="/2013/10/migrating-to-sandra-snow/">
          <i>Migrating To Sandra.Snow</i>
          <span style="float:right">.Net | Opensource</span>
            
            <p>A story about hosting a blog on github</p>

        </a>
      </li>
      <li class="post">
        <a href="/2012/02/a-few-caveats-when-using-strings-in-net/">
          <i>A few caveats when using Strings in .Net</i>
          <span style="float:right">.Net</span>
            
            <p>Strings in .Net are class objects and unlike value types they are stored on the heap.</p>

<p>According to msdn: <a href="http://msdn.microsoft.com/en-us/library/ee787088.aspx">http://msdn.microsoft.com/en-us/library/ee787088.aspx</a></p>

<blockquote>
  <p>Garbage collection occurs when one of the following conditions is true:</p>
  
  <ul>
  <li>The system has low physical memory.</li>
  <li>The memory that is used by allocated objects on the managed heap surpasses an acceptable threshold. This means that a threshold of acceptable memory usage has been exceeded on the managed heap. This threshold is continuously adjusted as the process runs.</li>
  <li>The GC.Collect  method is called. In almost all cases, you do not have to call this method, because the garbage collector runs continuously. This method is primarily used for unique situations and testing.</li>
  </ul>
</blockquote>

<p>Due to the second condition creating a string object can trigger garbage collection, which is costly in terms of performance. As developers we want to keep the string creation to a minimum. Since strings in .Net are immutable (manipulation results in a the creation of a new instance) means that combining two strings "string1" + "string2" results in the creation of three strings and editing a string results in creating a new one with the modification.</p>

<p>I think it's good to have the knowledge about how things work and why even though it's considered an micro optimization.</p>

        </a>
      </li>
      <li class="post">
        <a href="/2012/02/why-youd-want-to-place-a-shared-library-in-its-own/">
          <i>Why you'd want to place a shared library in its own solution</i>
          <span style="float:right">Software Development</span>
            
            <p>A situation occurred on work where we decided to refactor duplicated funtionality from two project (A and B) into a new shared library (X) DRYing things up. During this process the question of where to put X came up. I quickly answered "It's own solution" whereupon my colleague countered with the very simple yet valid question "Why" and I answered "Because" thinking it was really obvious and at the time couldn't understand why he'd even ask.</p>

<p>After work I realized this was a childish and not a very helpful answer caused by me just knowing it was a good thing to do and have never reflected upon the reason for it. So I decided to gather my thoughts and write this blog giving a better answer to his valid question.</p>

<h2>Presumptions</h2>

<ul>
<li>We will use internal Nuget feed for the library.</li>
<li>X could be placed in either A or B or separate library.</li>
</ul>

<h2>Consuming the Library</h2>

<p>Placing it in its own solution forces all projects consume it the same way, otherwise some projects would use nuget and one could use project reference. </p>

<h2>Future Changes</h2>

<p>If placed in A it would be easy to change according to requirement or quick fix for A and not think about B or any future consumers. Placing it in its own solution forces it to behave more like an independent library and less like a project reference. It makes more sense to open the solution for the library when change is needed than to open an unrelated solution containing the library.</p>

<h2>Unrelated Functionality</h2>

<p>Since the functionality is general and not related to neither A nor B, placing it in the same solution just because it's consumed by them is not a valid argument.</p>

<h2>Versioning</h2>

<p>The library has different release/deploy cycles than the consumers and using Nuget allows for choosing what version and if/when to upgrade. Different consumers can easily consume different versions of the library. </p>

<h2>YAGNI</h2>

<p>YAGNI was mentioned as an argument against placing X in its own library. I think developers are to fast to throw abbreviations as arguments thinking they are valid without actually considering the situation at hand, but this is material for a future post.</p>

        </a>
      </li>
      <li class="post">
        <a href="/2012/01/photoutil-v1-0-0-1-aka-speeding-up-a-c-project/">
          <i>PhotoUtil v1.0.0.1 aka Speeding up a c# project</i>
          <span style="float:right">.Net | Opensource</span>
            
            <p>I was investigating why my hobby project <a href="https://github.com/Dashue/MediaOrganizer">"PhotoUtil"</a> was being slow.
A program that takes a folder with a bunch of photos as inputs, processes the metadata from them, more specifically the date the picture was taken and then organizes them in folders based on this.</p>

<p>Following is a short recap of that procedure.</p>

<h2>Find out what's taking time 1: Analyze / Launch Performance Wizard</h2>

<p>The first thing that popped out at me was a DateTime creation which took 100% of the CPU time (according to the performance report). I grab the DateTimeOriginal value from exif metadata of a photo and convert it into datetime, only because it allowed for cleaner code when accessing the date and time values later on in the code. Apparently parsing strings into datetime is slow, so instead I got it to work with some string manipulation.</p>

<h2>Find out what's taking time 2: Analyze / Launch Performance Wizard</h2>

<p>When reading exif data using GDI+ from a file the whole image is read into memory using new Bitmap(Path); then the desired properties are fetched using GetProperty. This made me switch focus to increasing concurrent files being worked on (read parallelization) instead of minimizing process time of each file. With this in mind I rewrote my foreach loop into using the parallel library.</p>

<p>from</p>

<pre><code>foreach(var filepath in filepaths)
</code></pre>

<p>into</p>

<pre><code>Parallel.ForEach(filePaths, oldFilePath); 
</code></pre>

<h2>Taking it one step further:</h2>

<p>After finding out that the whole image is read into memory I set out to find an alternate approach of extracting EXIF data from a photo. It wasn't long before I found a sweet project called <a href="http://www.codeproject.com/Articles/36342/ExifLib-A-Fast-Exif-Data-Extractor-for-NET-2-0">ExifLib</a> on <a href="https://www.nuget.org/packages/ExifLib/">Nuget</a> which only reads the Exif data portion of an image. ExifLib is a wonderful lib created by Simon McKenzie only available as source code from codeproject.com but I'm hoping to convince him to put it up on NuGet so more people can find and make use of it.</p>

<h2>Results</h2>

<p>100 images processed on an Intel Core 2 duo</p>

<pre><code>Before optimizations:   00:00:20.8059121  
After optimizations:    00:00:11:4034511
Using ExifLib:          00:00:01.0714248
</code></pre>

        </a>
      </li>
      <li class="post">
        <a href="/2012/01/code-that-is-hard-to-be-covered-by-tests-is/">
          <i>Hard tested code</i>
          <span style="float:right">Software Development</span>
            
            <p>Code that is hard to be covered by tests is bug-prone and need to be redesigned to be easily coverable by easy tests.</p>

<p>Writing a complete test suite naturally leads to good design, enforcing low coupling and high cohesion.</p>

<p><a href="http://codebetter.com/patricksmacchia/2012/01/10/non-trivial-and-real-world-feedbacks-on-writing-unit-tests">http://codebetter.com/patricksmacchia/2012/01/10/non-trivial-and-real-world-feedbacks-on-writing-unit-tests</a></p>

        </a>
      </li>
  </ul> 

  <!-- Pagination links -->
  <div id="post-pagination" class="pagination">

   

      <!--<a href="/">Previous Page</a>-->

    <p class="previous">
      <a href="/page2">Next Page</a>
    </p>

  </div>


              </div>
              <!-- #content -->
          </div>
          <!-- #primary .site-content -->
      </div>
      <!-- #main -->

      <footer class="site-footer" role="contentinfo">
        <div class="site-info">
            Powered by <a href="https://github.com/Sandra/Sandra.Snow" rel="generator">Sandra.Snow</a>.	
        </div>
        <!-- .site-info -->
    </footer>
    <!-- #colophon .site-footer -->
</div>
<!-- #page .hfeed .site -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src='/javascripts/prettify.js' type='text/javascript'></script>

<script type="text/javascript">
var _gaq = _gaq || [];

_gaq.push(['_setAccount', 'UA-655975-13']);
_gaq.push(['_trackPageview']);
        
(function () {
    var ga = document.createElement('script');
    ga.type = 'text/javascript';
    ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(ga, s);
})();
</script>

<script type='text/javascript'>
  $(function () {
	    $("pre code").parent().each(function () {
	      if (!$(this).hasClass("prettyprint")) {
	        $(this).addClass("prettyprint");
	        a = true
	    }
		});

	    prettyPrint();
	});
</script>
<script type="text/javascript" src="https://d1xnn692s7u6t6.cloudfront.net/widget.js"></script>
<script type="text/javascript">(function k(){window.$SendToKindle&&window.$SendToKindle.Widget?$SendToKindle.Widget.init({}):setTimeout(k,500);})();</script>
</body>
</html>
